# Slopes: rate of change of elevation coming from the SRTM-30m map <https://www2.jpl.nasa.gov/srtm/>.
#         in Bio----- are defined as areas that, after modeling the digital elevation model
#         (http://download.kortforsyningen.dk/content/dhmterr%C3%A6n-16-m-grid)
#         on a 9.6 x 9.6 m scale, has an average slope of more than 15 degrees.
#         The layer is set to 0 for the places where intensive fields overlap
#         with the slopes. Sloping terrain is included as a potential indicator
#         of biodiversity because sloping areas are more difficult to cultivate
#         than flat terrain, and thus have an increased probability of containing
#         important habitats. --> in Bioscore 1
#------------------------------------------------------------------------------------
# Load the SRTM 90m resolution map
DNKSRTM30m <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Rasters/Denmark SRTM/DK-SRTM30m.tif")
# Estimate Mean elevation
DNKSRTM1km <- aggregate(DNKSRTM30m,
fact = c(30*(1/(60*60)))/res(DNKSRTM30m),
fun = mean)
rm(list=ls());gc()
library(raster)
library(rgdal)
library(maptools)
data(wrld_simpl)
voi = "wrb" # variable of interest
depth = "15-30cm"
quantile = "mean"
(layer = paste(variable,depth,quantile, sep="_")) # layer of interest
(variable = paste(url, voi, sep=""))
url = "https://files.isric.org/soilgrids/latest/data/" # Path to the webDAV data.
# define the Laver to download
voi = "wrb" # variable of interest
depth = "15-30cm"
quantile = "mean"
(variable = paste(url, voi, sep=""))
(layer = paste(variable,depth,quantile, sep="_")) # layer of interest
(vrt_layer = paste(layer, '.vrt', sep=""))
dir(paste0(url,voi))
list(paste0(url,voi))
list.files(paste0(url,voi))
SOILGRID <- raster("/Users/alejandroordonez/Dropbox/Courses_&_Conferences/2020/Courses/Statistical & Geospatial modeling/Lectures-Practical/16. Project/Data/Rasters/Soils/SoilsGrid/wrb_0-5cm_mean.tif")
plot(SOILGRID)
1999-2019
20*12
rm(list=ls());gc()
library(raster)
library(rgdal)
library(maptools)
data(wrld_simpl)
rm(list=ls());gc()
library(raster)
library(rgdal)
library(maptools)
data(wrld_simpl)
#------------------------------------------------------------------------------------
# Non-Bioscore predictors based on SRTM
# NDVI: The Normalized Difference Vegetation Index (NDVI) is an indicator of the greenness of the biomes.
#------------------------------------------------------------------------------------
# Denmark's polygon
## Load high resolution map of Denmark
DKMap <- shapefile("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/BaselineShapes/DNK_admin/GADML_DNK0.shp")
## Re-project the spatial polygon of Denmark to UTM
DK.Map.UTM <- spTransform(x = DKMap,
CRSobj = CRS("+proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs"))
NDVI.list <- dir("/Volumes/Seagate Expansion/Data/DENMARK/NDVI/Data/SHORT TERM STATISTICS/")
NDVI.list
x<-NDVI.list[1]
x
Dir.WData <- "/Volumes/Seagate Expansion/Data/DENMARK/NDVI/Data/SHORT TERM STATISTICS/"
NDVI.list <- dir(Dir.WData)
NDVI.list
x<-NDVI.list[1]
x
dir(paste0(Dir.WData,x,"/20150101",))
paste0(Dir.WData,x,"/20150101",)
Dir.WData <- "/Volumes/Seagate Expansion/Data/DENMARK/NDVI/Data/SHORT TERM STATISTICS/"
NDVI.list <- dir(Dir.WData)
x<-NDVI.list[1]
paste0(Dir.WData,x,"/20150101",)
paste0(Dir.WData,x,"/20150101")
dir(paste0(Dir.WData,x,"/20150101"))
dir(paste0(Dir.WData,x,"/20150101"),pattern="mean")
?dir
dir(paste0(Dir.WData,x,"/20150101"),pattern="mean",full.names =T)
raster(dir(paste0(Dir.WData,x,"/20150101"),pattern="mean",full.names =T))
NDVI.list <- dir(Dir.WData,pattern="mean")
NDVI.list <- dir(Dir.WData)
x<-NDVI.list[1]
raster(dir(paste0(Dir.WData,x,"/20150101"),pattern="mean",full.names =T))
NDVITmp <- raster(dir(paste0(Dir.WData,x,"/20150101"),pattern="mean",full.names =T))
NDVITmp2 <-mask(NDVITmp, DKMap)
plot(NDVITmp2)
hist(NDVITmp2)
rm(list=ls());gc()
library(raster)
library(rgdal)
library(maptools)
data(wrld_simpl)
rm(list=ls());gc()
library(raster)
library(rgdal)
library(maptools)
data(wrld_simpl)
#------------------------------------------------------------------------------------
# Non-Bioscore predictors based on SRTM
# NDVI: The Normalized Difference Vegetation Index (NDVI) is an indicator of the greenness of the biomes.
#------------------------------------------------------------------------------------
# Denmark's polygon
## Load high resolution map of Denmark
DKMap <- shapefile("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/BaselineShapes/DNK_admin/GADML_DNK0.shp")
## Re-project the spatial polygon of Denmark to UTM
DK.Map.UTM <- spTransform(x = DKMap,
CRSobj = CRS("+proj=utm +zone=32 +ellps=GRS80 +units=m +no_defs"))
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# Load the NDVI Data
Dir.WData <- "/Volumes/Seagate Expansion/Data/DENMARK/NDVI/Data/SHORT TERM STATISTICS/"
NDVI.DirList <- dir(Dir.WData)
NDVI.List <- lapply(NDVI.DirList,
function(x){
NDVITmp <- raster(dir(paste0(Dir.WData,x,"/20150101"),pattern="mean",full.names =T))
NDVITmp2 <-mask(NDVITmp, DKMap)
retun(NDVITmp2)
})
NDVI.List <- lapply(NDVI.DirList,
function(x){
NDVITmp <- raster(dir(paste0(Dir.WData,x,"/20150101"),pattern="mean",full.names =T))
NDVITmp2 <-mask(NDVITmp, DKMap)
return(NDVITmp2)
})
NDVI.Stack <- do.call("stack",NDVI.List)
NDVI.Mean <- mean(NDVI.Stack)
pot(NDVI.Stack)
plot(NDVI.Stack)
plot(NDVI.Mean)
NDVI.Mean <- cal(NDVI.Stack,function(x){mean(x,na,rm=T)})
NDVI.Mean <- calc(NDVI.Stack,function(x){mean(x,na,rm=T)})
?calc
NDVI.Mean <- calc(NDVI.Stack,mean,na,rm=T)
NDVI.Mean <- calc(NDVI.Stack,mean,na.rm=T)
plot(NDVI.Stack)
plot(NDVI.Mean)
hist(NDVI.Mean)
NDVI.Mean
writeRaster(x = NDVI.Mean, # raster to save
filename = "~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/NDVI/NDVI.tif", # Name of the raster
format="GTiff", overwrite=TRUE) # Arguments
NatDenCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/Nature Density/NatDens_Cor.tif")
NatDenCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/Nature Density/NatDens_Cor.tif")
NatDenCor
rm(list=ls());gc()
library(raster)
library(rgdal)
library(maptools)
data(wrld_simpl)
#------------------------------------------------------------------------------------
# Add And values to Biodiveristy Data
#------------------------------------------------------------------------------------
#### BIOWIDE
# load the Raw data
DK.Biodiv.In <- readxl::read_excel("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Biodiveristy/Biowide/occurrence.xlsx")
names(DK.Biodiv.In)
# Which groups where sampled?
unique(DK.Biodiv.In$phylum)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# Summarize the richness
DK.BiodivLatLongPaste <- c(paste0(DK.Biodiv.In$decimalLongitude,"-",DK.Biodiv.In$decimalLatitude))
funcCont <- function(x){length(unique(x))}
RichSumm <- tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste,
DK.Biodiv.In$phylum),
FUN = funcCont)
# Make the first summary table focusing on Arthropoda and Plants
DK.Biodiv <- data.frame(ID = 1:130,
decimalLongitude = do.call("c",lapply(strsplit(row.names(RichSumm),"-"),function(x){as.numeric(x[1])})),
decimalLatitude = do.call("c",lapply(strsplit(row.names(RichSumm),"-"),function(x){as.numeric(x[2])})),
S.Arthropoda = RichSumm[,"Arthropoda"], # Species richness Arthropoda
S.Spermatophyte = c(apply(RichSumm[,c("Magnoliophyta","Pinophyta")],1,sum, na.rm=T)), # Species richness vascular plant
S.Magnoliophyta = RichSumm[,"Magnoliophyta"] # # Species richness flowering plants
)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# Prep to extract env data
## Make a spatial points dataframe
DK.BiodivPntSHP <- SpatialPointsDataFrame(coords = DK.Biodiv[,c("decimalLongitude","decimalLatitude")],
proj4string = CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"),
data = DK.Biodiv)
## Re-porject the spatial points data.frame to UTM zone of Denmark https://epsg.io/25832 https://sdfe.dk/media/2917583/001-etrs89-utm.pdf
DK.BiodivPntSHP.laea <- spTransform(x = DK.BiodivPntSHP,
CRSobj = CRS("+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs"))
## Re-project the spatial polygon of Denmark to UTM
DK.BiodivPntSHP.UTM <- spTransform(x = DK.BiodivPntSHP,
CRSobj = CRS("+proj=utm +zone=32 +ellps=GRS80 +units=m +no_def"))
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
## Extract the Region
landsdeleSHP <- shapefile("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/BaselineShapes/DNK_admin/GADML_DNK1.shp")
DK.Biodiv$landsdele <- over(DK.BiodivPntSHP, # The SpatialPointDataFrame
landsdeleSHP["NAME_1"] # The attribute to extract
)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
## Nature Density:  Nature density is calculated as the proportion of forests and
##                  protected light-open nature types in a nationwide network of
##                  cells of 1 x 1 km.
NatDenCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/Nature Density/NatDens_Cor.tif")
DK.Biodiv$NatDensCor <- extract(NatDenCor,DK.BiodivPntSHP.laea)
NatDenBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/Nature Density/NatDens_BaseMap.tif")
DK.Biodiv$NatDensBasMp <- extract(NatDenBasemap,DK.BiodivPntSHP.laea)
NatDenBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/Nature Density/NatDens_BaseMap.tif")
DK.Biodiv$NatDensBasMp <- extract(NatDenBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$NatDensBasMp)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$NatDenCor)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$NatDensCor)
OpnNatCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/2. Open Nature Density/OpnNatDens_Cor.tif")
DK.Biodiv$OpnNatCor <- extract(OpnNatCor,DK.BiodivPntSHP.laea)
OpnNatBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/2. Open Nature Density/OpnNatDens_Basemap.tif")
DK.Biodiv$OpnNatBasMp <- extract(OpnNatBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$NatDensBasMp)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$OpnNatCor)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$OpnNatCor)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$OpnNatBasMp)
ForDenCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/2. Open Nature Density/OpnNatDens_Cor.tif")
DK.Biodiv$ForDenCor <- extract(ForDenCor,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$ForDenCor)
ForDenBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/2. Open Nature Density/OpnNatDens_Basemap.tif")
DK.Biodiv$ForDenBasMp <- extract(ForDenBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$ForDenBasMp)
IntAgr1kBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/Agro Density/IntAgroDens_Basemap.tif")
DK.Biodiv$IntAgr1kBasMp <- extract(IntAgr1kBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$IntAgr1kBasMp)
AgrCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/2. Open Nature Density/OpnNatDens_Cor.tif")
DK.Biodiv$AgrCor <- extract(AgrCor,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$AgrCor)
AgrBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/Agro Density/IntAgroDens_Basemap.tif")
DK.Biodiv$AgrBasMp <- extract(AgrBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$AgrBasMp)
AgrCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/2. Open Nature Density/AgroDens_Cor.tif")
AgrCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/2. Open Nature Density/AgroDens_Cor.tif")
AgrBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/4.Agro Density/AgroDens_Basemap.tif")
DK.Biodiv$AgrBasMp <- extract(AgrBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$AgrBasMp)
AgrCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/4.Agro Density/AgroDens_Cor.tif")
DK.Biodiv$AgrCor <- extract(AgrCor,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$AgrCor)
ForDenCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/3. Forest Density/ForestDens_Cor")
ForDenCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/3. Forest Density/ForestDens_Cor.tif")
DK.Biodiv$ForDenCor <- extract(ForDenCor,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$ForDenCor)
ForDenBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/3. Forest Density/ForestDens_Basemap.tif")
DK.Biodiv$ForDenBasMp <- extract(ForDenBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$ForDenBasMp)
WetLndCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/5. Wetland Density/WetLndDens_Cor.tif")
DK.Biodiv$WetLndCor <- extract(AgrCor,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$WetLndCor)
DK.Biodiv$WetLndBasMp <- extract(WetLndBasemap,DK.BiodivPntSHP.UTM)
WetLndBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/5. Wetland Density/WetLndDens_BaseMap.tif")
DK.Biodiv$WetLndBasMp <- extract(WetLndBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$WetLndBasMp)
WetLndBasemap <- raster("/Users/alejandroordonez/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/6 Distance to Coast/DISTtoCOAST.tif")
Dis2Cost <- raster("/Users/alejandroordonez/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/6 Distance to Coast/DISTtoCOAST.tif")
Dis2Cost
Dis2Cost <- raster("/Users/alejandroordonez/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/Distance to Coast/DISTtoCOAST.tif")
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$NatDensCor)dir(~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data)
dir("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data")
dir("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/6. Distance to Coast")
Dis2Cost <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/6. Distance to Coast/DISTtoCOAST.tif")
DK.Biodiv$Dis2Cost <- extract(Dis2Cost,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$Dis2Cost)
Dis2Cost
HII <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/7. HumanFootprint/HII.tif")
dir("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/6. Distance to Coast/DISTtoCOAST.tif")
HII
HII <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/7. HumanFootprint/HII.tif")
DK.Biodiv$HII <- extract(Dis2Cost,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$HII)
HII <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/7. HumanFootprint/HII.tif")
DK.Biodiv$HII <- extract(Dis2Cost,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$HII)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$Dis2Cost)
Dis2Cost <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/6. Distance to Coast/DISTtoCOAST.tif")
DK.Biodiv$Dis2Cost <- extract(Dis2Cost,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$Dis2Cost)
HII <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/7. HumanFootprint/HII.tif")
DK.Biodiv$HII <- extract(HII,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$HII)
Slope <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/8. Slope/Slope.tif")
Slope
DK.BiodivPntSHP
DK.Biodiv$Slope <- extract(Slope,DK.BiodivPntSHP)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$Slope)
Slope30mAgg <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/8. Slope/Slope_30mAgg.tif")
DK.Biodiv$Slope30mAgg <- extract(Slope30mAgg,DK.BiodivPntSHP)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$Slope30mAgg)
SoilHet <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/10. Soil type heterogenity/SOILType-SOILGRD.tif")
DK.Biodiv$SoilHet <- extract(SoilHet,DK.BiodivPntSHP)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$SoilHet)
DK.Biodiv$SoilHet <- factor(extract(SoilHet,DK.BiodivPntSHP))
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$SoilHet)
SoilpH <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/11. pH/SoilpH.tif")
SoilpH
Slope30mAgg
DK.Biodiv$SoilpH <- factor(extract(SoilpH,DK.BiodivPntSHP))
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$SoilpH)
DK.Biodiv$SoilpH <- extract(SoilpH,DK.BiodivPntSHP)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$SoilpH)
DK.Biodiv$SoilpH==0
DK.Biodiv$SoilpH[DK.Biodiv$SoilpH==0] <- NA
DK.Biodiv$SoilpH
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$SoilpH)
ElevHet <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/9. Elevantion Heterogenity/SRTM30_SD_1km.tif")
ElevHet <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/9. Elevantion Heterogenity/SRTM30_SD_1km.tif")
DK.Biodiv$ElevHet <- extract(ElevHet,DK.BiodivPntSHP)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$ElevHet)
ElevHet <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/9. Elevantion Heterogenity/SRTM30_SD_1km.tif")
ElevHet
plot(ElevHet)
NDVI <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/12. NDVI/NDVItif")
NDVI <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/12. NDVI/NDVI.tif")
DK.Biodiv$NDVI <- extract(NDVI,DK.BiodivPntSHP)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$NDVI)
MAT <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO01-CHELSA.tif")
DK.Biodiv$MAT <- extract(NDVI,DK.BiodivPntSHP)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$MAT)
MAT <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO01-CHELSA.tif")
MAT
DK.Biodiv$MAT <- extract(NDVI,DK.BiodivPntSHP.laea)
MAT
DK.BiodivPntSHP.laea
MAT <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO01-CHELSA.tif")
DK.Biodiv$MAT <- extract(NDVI,DK.BiodivPntSHP.laea)
MAT <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO01-CHELSA.tif")
DK.Biodiv$MAT <- extract(MAT,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$MAT)
ElevHet <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/9. Elevantion Heterogenity/SRTM30_SD_1km.tif")
DK.Biodiv$ElevHet <- extract(ElevHet,DK.BiodivPntSHP)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$ElevHet)
ElevHet <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/9. Elevantion Heterogenity/SRTM30_SD_1km.tif")
TempSeas <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO04-CHELSA.tif")
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$MAT)
TempSeas <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO04-CHELSA.tif")
DK.Biodiv$TempSeas <- extract(TempSeas,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$TempSeas)
AnnPrec <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO12-CHELSA.tif")
DK.Biodiv$TempSeas <- extract(AnnPrec,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$AnnPrec)
AnnPrec <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO12-CHELSA.tif")
DK.Biodiv$AnnPrec <- extract(AnnPrec,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$AnnPrec)
PrecSea <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO15-CHELSA.tif")
DK.Biodiv$TempSeas <- extract(PrecSea,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$PrecSea)
PrecSea <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO15-CHELSA.tif")
DK.Biodiv$PrecSea <- extract(PrecSea,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$PrecSea)
PET <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_PET-CHELSA.tif")
DK.Biodiv$PET <- extract(PET,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$PET)
tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste),
FUN = funcCont)
RichSumm <- tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste,
DK.Biodiv.In$phylum),
FUN = funcCont)
RichSumm
names(RichSumm)
col.names(RichSumm)
dim.names(RichSumm)
dimnames(RichSumm)
RichSumm$S.AllGrp <- as.nuameric(tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste),
FUN = funcCont))
RichSumm$S.AllGrp <- as.numeric(tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste),
FUN = funcCont))
head(RichSumm)
RichSumm <- tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste,
DK.Biodiv.In$phylum),
FUN = funcCont)
class(RichSumm)
RichSumm <- as.data.frame(RichSumm)
RichSumm$S.AllGrp <- as.numeric(tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste),
FUN = funcCont))
RichSumm <- tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste,
DK.Biodiv.In$phylum),
FUN = funcCont)
RichSumm <- as.data.frame(RichSumm)
RichSumm$AllGrp <- as.numeric(tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste),
FUN = funcCont))
rm(list=ls());gc()
library(raster)
library(rgdal)
library(maptools)
data(wrld_simpl)
#------------------------------------------------------------------------------------
# Add And values to Biodiveristy Data
#------------------------------------------------------------------------------------
#### BIOWIDE
# load the Raw data
DK.Biodiv.In <- readxl::read_excel("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Biodiveristy/Biowide/occurrence.xlsx")
names(DK.Biodiv.In)
# Which groups where sampled?
unique(DK.Biodiv.In$phylum)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# Summarize the richness
DK.BiodivLatLongPaste <- c(paste0(DK.Biodiv.In$decimalLongitude,"-",DK.Biodiv.In$decimalLatitude))
funcCont <- function(x){length(unique(x))}
RichSumm <- tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste,
DK.Biodiv.In$phylum),
FUN = funcCont)
RichSumm <- as.data.frame(RichSumm)
RichSumm$AllGrp <- as.numeric(tapply(DK.Biodiv.In$scientificName,
INDEX = list(DK.BiodivLatLongPaste),
FUN = funcCont))
head(RichSumm)
# Make the first summary table focusing on Arthropoda and Plants
DK.Biodiv <- data.frame(ID = 1:130,
decimalLongitude = do.call("c",lapply(strsplit(row.names(RichSumm),"-"),function(x){as.numeric(x[1])})),
decimalLatitude = do.call("c",lapply(strsplit(row.names(RichSumm),"-"),function(x){as.numeric(x[2])})),
S.AllGrp = RichSumm[,"AllGrp"], # All evaluated Groups
S.Arthropoda = RichSumm[,"Arthropoda"], # Species richness Arthropoda
S.Spermatophyte = c(apply(RichSumm[,c("Magnoliophyta","Pinophyta")],1,sum, na.rm=T)), # Species richness vascular plant
S.Magnoliophyta = RichSumm[,"Magnoliophyta"] # # Species richness flowering plants
)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
# Prep to extract env data
## Make a spatial points dataframe
DK.BiodivPntSHP <- SpatialPointsDataFrame(coords = DK.Biodiv[,c("decimalLongitude","decimalLatitude")],
proj4string = CRS("+proj=longlat +ellps=WGS84 +datum=WGS84 +no_defs"),
data = DK.Biodiv)
## Re-porject the spatial points data.frame to UTM zone of Denmark https://epsg.io/25832 https://sdfe.dk/media/2917583/001-etrs89-utm.pdf
DK.BiodivPntSHP.laea <- spTransform(x = DK.BiodivPntSHP,
CRSobj = CRS("+proj=laea +lat_0=52 +lon_0=10 +x_0=4321000 +y_0=3210000 +ellps=GRS80 +units=m +no_defs"))
## Re-project the spatial polygon of Denmark to UTM
DK.BiodivPntSHP.UTM <- spTransform(x = DK.BiodivPntSHP,
CRSobj = CRS("+proj=utm +zone=32 +ellps=GRS80 +units=m +no_def"))
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
## Extract the Region
landsdeleSHP <- shapefile("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/BaselineShapes/DNK_admin/GADML_DNK1.shp")
DK.Biodiv$landsdele <- over(DK.BiodivPntSHP, # The SpatialPointDataFrame
landsdeleSHP["NAME_1"] # The attribute to extract
)
#++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++
## Nature Density:  Nature density is calculated as the proportion of forests and
##                  protected light-open nature types in a nationwide network of
##                  cells of 1 x 1 km.
# NatDenCor <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/1. Nature Density/NatDens_Cor.tif")
# DK.Biodiv$NatDensCor <- extract(NatDenCor,DK.BiodivPntSHP.laea)
# plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$NatDensCor)
NatDenBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/1. Nature Density/NatDens_BaseMap.tif")
DK.Biodiv$NatDensBasMp <- extract(NatDenBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$NatDensBasMp)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$NatDensBasMp)
plot(DK.Biodiv$S.Magnoliophyta~DK.Biodiv$NatDensBasMp)
OpnNatBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/2. Open Nature Density/OpnNatDens_Basemap.tif")
DK.Biodiv$OpnNatBasMp <- extract(OpnNatBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$OpnNatBasMp)
ForDenBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/3. Forest Density/ForestDens_Basemap.tif")
DK.Biodiv$ForDenBasMp <- extract(ForDenBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$ForDenBasMp)
AgrBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/4.Agro Density/AgroDens_Basemap.tif")
DK.Biodiv$AgrBasMp <- extract(AgrBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$AgrBasMp)
WetLndBasemap <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/5. Wetland Density/WetLndDens_BaseMap.tif")
DK.Biodiv$WetLndBasMp <- extract(WetLndBasemap,DK.BiodivPntSHP.UTM)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$WetLndBasMp)
Dis2Cost <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/6. Distance to Coast/DISTtoCOAST.tif")
DK.Biodiv$Dis2Cost <- extract(Dis2Cost,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$Dis2Cost)
HII <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/7. HumanFootprint/HII.tif")
DK.Biodiv$HII <- extract(HII,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$HII)
Slope30mAgg <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/8. Slope/Slope_30mAgg.tif")
DK.Biodiv$Slope30mAgg <- extract(Slope30mAgg,DK.BiodivPntSHP)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$Slope30mAgg)
SoilTypHet <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/10. Soil type heterogenity/SOILType-SOILGRD.tif")
DK.Biodiv$SoilTypHet <- factor(extract(SoilTypHet,DK.BiodivPntSHP))
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$SoilTypHet)
SoilpH <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/11. pH/SoilpH.tif")
DK.Biodiv$SoilpH <- extract(SoilpH,DK.BiodivPntSHP)
DK.Biodiv$SoilpH[DK.Biodiv$SoilpH==0] <- NA
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$SoilpH)
NDVI <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/12. NDVI/NDVI.tif")
DK.Biodiv$NDVI <- extract(NDVI,DK.BiodivPntSHP)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$NDVI)
MAT <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO01-CHELSA.tif")
DK.Biodiv$MAT <- extract(MAT,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$MAT)
TempSeas <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO04-CHELSA.tif")
DK.Biodiv$TempSeas <- extract(TempSeas,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$TempSeas)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$MAT)
MAT <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO01-CHELSA.tif")
DK.Biodiv$MAT <- extract(MAT,DK.BiodivPntSHP.laea)/10
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$MAT)
MAT <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO01-CHELSA.tif")
DK.Biodiv$MAT <- extract(MAT,DK.BiodivPntSHP.laea)/10
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$MAT)
TempSeas <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO04-CHELSA.tif")
DK.Biodiv$TempSeas <- extract(TempSeas,DK.BiodivPntSHP.laea)/10
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$TempSeas)
AnnPrec <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO12-CHELSA.tif")
DK.Biodiv$AnnPrec <- extract(AnnPrec,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$AnnPrec)
PrecSea <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_BIO15-CHELSA.tif")
DK.Biodiv$PrecSea <- extract(PrecSea,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$PrecSea)
PET <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/13. Climate/DK_PET-CHELSA.tif")
DK.Biodiv$PET <- extract(PET,DK.BiodivPntSHP.laea)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$PET)
ElevHet <- raster("~/Dropbox/Courses_&_Conferences/2022/Courses/Statistical and Geospatial Modeling/Lectures-Practical/Project/Data/9. Elevantion Heterogenity/SRTM30_SD_1km.tif")
DK.Biodiv$ElevHet <- extract(ElevHet,DK.BiodivPntSHP)
plot(DK.Biodiv$S.AllGrp~DK.Biodiv$ElevHet)
